BER1 = [
 	22,	5.69e-9,	5.69e-9,	2.94e-8,	5.1e-9,     8.82e-9,	1.43e-4;...
 	21,	2.84e-8,	2.92e-8,	1.43e-7,	2.69e-8,	5.65e-8,	2.1e-4;...
 	20,	1.53e-7,	1.52e-7,	7.31e-7,	1.46e-7,	2.72e-7,	3e-4;...
 	19,	6.76e-7,	6.77e-7,	2.57e-6,	6.83e-7,	1.16e-6,	4.03e-4;...
 	18,	2.22e-6,	2.22e-6,	7.89e-6,	2.22e-6,	3.51e-6,	5.31e-4;...
 	17,	7.55e-6,	7.56e-6,	2.4e-5,     7.53e-6,	1.13e-5,	6.86e-4;...
 	16,	1.92e-5,	1.93e-5,	5.42e-5,	1.9e-5,     2.64e-5,	8.33e-4;...
 	15,	4.65e-5,	4.65e-5,	1.13e-4,	4.68e-5,	6.14e-5,	9.98e-4;...
 	14,	1.02e-4,	1.02e-4,	2.14e-4,	1.01e-4,	1.24e-4,	1.18e-3;...
 	13,	2.13e-4,	2.13e-4,	3.81e-4,	2.12e-4,	2.47e-4,	1.37e-3;...
 	12,	4.11e-4,	4.11e-4,	6.27e-4,	4.11e-4,	4.64e-4,	2.02e-3;...
 	11,	7.23e-4,	7.23e-4,	1e-3,       7.19e-4,	7.92e-4,	3.7e-3;...
 	10,	1.22e-3,	1.22e-3,	1.57e-3,	1.23e-3,	1.35e-3,	2e-2;...
];
BER2 = [
 	21,	1.96e-10,	1.96e-10,	0e0,        1.96e-10,	7.84e-10,	0e0;...
 	20,	2.75e-9,	2.75e-9,	1.18e-9,	3.14e-9,	9.61e-9,	2.07e-2;...
 	19,	3.39e-8,	3.33e-8,	2.31e-8,	3.33e-8,	7.88e-8,	6.96e-3;...
 	18,	2.27e-7,	2.28e-7,	1.58e-7,	2.18e-7,	5.72e-7,	2.4e-2;...
 	17,	1.36e-6,	1.36e-6,	9.6e-7,     1.34e-6,	3.31e-6,	2.26e-2;...
 	16,	6.01e-6,	6e-6,       4.54e-6,	5.98e-6,	1.48e-5,	1.12e-2;...
 	15,	1.99e-5,	1.99e-5,	1.56e-5,	1.95e-5,	4.37e-5,	1.45e-2;...
 	14,	5.83e-5,	5.83e-5,	4.75e-5,	5.78e-5,	1.27e-4,	2.37e-2;...
 	13,	1.42e-4,	1.42e-4,	1.19e-4,	1.42e-4,	2.99e-4,	0e0;...
 	12,	3.11e-4,	3.11e-4,	2.67e-4,	3.09e-4,	5.96e-4,	1.9e-2;...
 	11,	6.29e-4,	6.29e-4,	5.54e-4,	6.27e-4,	1.12e-3,	0e0;...
 	10,	1.11e-3,	1.11e-3,	9.95e-4,	1.11e-3,	1.83e-3,	0e0;...
];
BER3 = [
 	10,	2.72e-3,	2.72e-3,	3.16e-3,	2.72e-3,	2.58e-3,	0e0;...
 	11,	1.96e-3,	1.96e-3,	2.38e-3,	1.95e-3,	1.83e-3,	0e0;...
 	12,	1.4e-3,     1.4e-3,     1.77e-3,	1.39e-3,	1.29e-3,	0e0;...
 	13,	9.61e-4,	9.6e-4,     1.3e-3,     9.68e-4,	8.81e-4,	0e0;...
 	14,	6.26e-4,	6.26e-4,	9.11e-4,	6.24e-4,	5.64e-4,	0e0;...
 	15,	4.08e-4,	4.08e-4,	6.31e-4,	4.1e-4,     3.63e-4,	0e0;...
 	16,	2.5e-4,     2.5e-4,     4.13e-4,	2.51e-4,	2.19e-4,	0e0;...
 	17,	1.46e-4,	1.46e-4,	2.61e-4,	1.47e-4,	1.26e-4,	0e0;...
 	18,	7.58e-5,	7.57e-5,	1.47e-4,	7.77e-5,	6.4e-5,     0e0;...
 	19,	3.89e-5,	3.89e-5,	7.96e-5,	3.98e-5,	3.17e-5,	0e0;...
 	20,	1.96e-5,	1.95e-5,	4.4e-5,     2.05e-5,	1.56e-5,	0e0;...
 	21,	8.91e-6,	8.9e-6,     2.08e-5,	9.69e-6,	6.94e-6,	0e0;...
 	22,	3.64e-6,	3.65e-6,	9.65e-6,	4.23e-6,	2.74e-6,	0e0;...
 	23,	1.47e-6,	1.47e-6,	3.97e-6,	1.77e-6,	1.07e-6,	0e0;...
 	24,	5.41e-7,	5.41e-7,	1.73e-6,	6.86e-7,	3.52e-7,	0e0;...
 	25,	2.28e-7,	2.27e-7,	7.6e-7,     2.69e-7,	1.24e-7,	0e0;...
 	26,	9.02e-8,	9.02e-8,	4.04e-7,	9.2e-8,     4.04e-8,	0e0;...
];

BER_awgn = [
 	4,	2.93e-3,	2.93e-3,	2.62e-3,	2.93e-3,	3.56e-3,	1.94e-3;...
 	5,	1.72e-3,	1.72e-3,	1.46e-3,	1.72e-3,	2.08e-3,	1.01e-3;...
 	6,	9.94e-4,	9.94e-4,	7.91e-4,	9.92e-4,	1.18e-3,	5.05e-4;...
 	7,	5.03e-4,	5.03e-4,	3.78e-4,	5.01e-4,	5.92e-4,	2.11e-4;...
 	8,	2.23e-4,	2.23e-4,	1.56e-4,	2.21e-4,	2.58e-4,	7.15e-5;...
 	9,	8.87e-5,	8.87e-5,	6.54e-5,	8.79e-5,	1.02e-4,	2.07e-5;...
 	10,	3.01e-5,	3.01e-5,	1.78e-5,	2.98e-5,	3.34e-5,	4.69e-6;...
 	11,	8.25e-6,	8.26e-6,	4.14e-6,	8.13e-6,	8.94e-6,	7.06e-7;...
 	12,	2.06e-6,	2.06e-6,	8.88e-7,	2.02e-6,	2.19e-6,	9.02e-8;...
 	13,	3.78e-7,	3.79e-7,	1.36e-7,	3.72e-7,	3.99e-7,	8.82e-9;...
 	14,	4.9e-8,     4.88e-8,	1.37e-8,	4.67e-8,	5.22e-8,	0e0;...
 	15,	7.65e-9,	7.45e-9,	2.35e-9,	6.86e-9,	6.67e-9,	0e0;...
];



figure(1); clf;
semilogy(BER1(:,1),BER1(:,2:end));
grid on;
marge = axis;
axis([marge(1)-1 marge(2)+1  1e-9 1e-1]);

latexWidth = 5;
latexHeight = 4;
ff = gcf;
homer = ff.Units;
ff.Units = 'inches';
bart = ff.Position;
ff.Position = [bart(1:2) latexWidth latexHeight];
ff.PaperPositionMode = 'auto';
ff.Units = homer;
xlabel('cycles/sample')
% ylabel('\Psi (dB)')
ylabel('BER')
% title('SOQPSK-TG Constellation')
% legend('SOQPSK-TG Power Spectrum','Location','Best')
print(ff, '-depsc', ['FDE2_spectrum_PSI']) %save as eps a 

% figure(11);
% stem(-max_lag:max_lag,abs(R));
% grid on;