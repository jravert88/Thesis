clear all
a = [3104	12672	1	3.45434	3.70019	36.7594
3104	12672	2	5.20605	4.31597	36.7278
3104	12672	3	7.25363	4.95546	36.7429
3104	12672	4	8.98502	5.72806	36.7123
3104	12672	5	11.2618	6.4617	36.6883
3104	12672	6	12.702	7.30141	36.6907
3104	12672	7	13.4511	8.09338	36.7104
3104	12672	8	13.5871	8.8935	36.723
3104	12672	9	16.336	9.66954	36.6725
3104	12672	10	18.4585	10.5519	36.7119
3104	12672	11	19.6254	11.3827	36.7316
3104	12672	12	20.259	12.2742	36.6793
3104	12672	13	21.0185	13.0708	36.675
3104	12672	14	21.8658	14.029	36.6633
3104	12672	15	22.6991	14.9032	36.7126
3104	12672	16	21.6551	15.8073	36.7554
3104	12672	17	24.3373	16.6435	36.7123
3104	12672	18	25.1731	17.6733	36.7254
3104	12672	19	25.8598	18.6033	36.7224
3104	12672	20	26.6188	19.5626	36.7446
3104	12672	21	27.6585	20.4227	36.7288
3104	12672	22	28.6537	21.4732	36.7052
3104	12672	23	29.3924	22.4083	36.671
3104	12672	24	30.263	23.3962	36.7121
3104	12672	25	30.9131	24.2547	36.6962
3104	12672	26	32.1822	25.3218	36.7263
3104	12672	27	34.0507	26.261	36.7257
3104	12672	28	33.9607	27.243	36.749
3104	12672	29	34.8256	28.1628	36.6849
3104	12672	30	35.7862	29.1734	36.6879
3104	12672	31	36.7112	30.1166	36.6429
3104	12672	32	38.1598	31.0946	36.7434
3104	12672	33	38.5018	32.0007	36.7522
3104	12672	34	39.6483	33.0654	36.6934
3104	12672	35	40.619	34.0198	36.6738
3104	12672	36	41.634	34.9666	36.6645
3104	12672	37	42.6033	35.8448	36.7291
3104	12672	38	43.6464	36.9284	36.694
3104	12672	39	44.606	37.8514	36.713
3104	12672	40	45.7335	38.8222	36.7111
3104	12672	41	46.581	39.7136	36.6986
3104	12672	42	47.6895	40.7933	36.6859
3104	12672	43	48.7027	41.7055	36.7011
3104	12672	44	49.7612	42.6845	36.722
3104	12672	45	50.7117	43.5888	36.7008
3104	12672	46	51.862	44.658	36.6807
3104	12672	47	52.8887	45.5652	36.7042
3104	12672	48	54.4804	46.5329	36.724
3104	12672	49	54.7234	47.4353	36.7204
3104	12672	50	55.9117	48.468	36.7282
3104	12672	51	56.9049	49.4099	36.7564
3104	12672	52	57.9836	50.3913	36.6969
3104	12672	53	58.8821	51.3307	36.7078
3104	12672	54	59.978	52.3428	36.7066
3104	12672	55	60.9422	53.3112	36.6556
3104	12672	56	62.0734	54.2757	36.6801
3104	12672	57	62.8917	55.194	36.6711
3104	12672	58	63.9974	56.3406	36.7082
3104	12672	59	65.0055	57.2469	36.6915
3104	12672	60	66.0557	58.1665	36.722
3104	12672	61	66.9893	59.0392	36.6836
3104	12672	62	68.0843	60.0854	36.7737
3104	12672	63	69.0898	61.0064	36.6958
3104	12672	64	70.5846	61.9903	36.6291
3104	12672	65	70.9653	62.9635	36.6916
3104	12672	66	72.1655	63.958	36.7373
3104	12672	67	73.292	64.8889	36.6427
3104	12672	68	74.2546	65.8612	36.7182
3104	12672	69	75.2015	66.7924	36.6955
3104	12672	70	76.3082	67.8121	36.6548
3104	12672	71	77.2927	68.7773	36.7485
3104	12672	72	78.3708	69.7655	36.7094
3104	12672	73	79.3141	70.6784	36.6967
3104	12672	74	80.4476	71.685	36.7336
3104	12672	75	81.4656	72.6235	36.7128
3104	12672	76	82.5599	73.6207	36.7171
3104	12672	77	83.5384	74.5274	36.6738
3104	12672	78	84.6837	75.5669	36.7444
3104	12672	79	85.7083	76.5315	36.6898
3104	12672	80	86.8883	77.4634	36.7519
3104	12672	81	87.6863	78.3769	36.6757
3104	12672	82	88.9075	79.4155	36.6613
3104	12672	83	89.9706	80.3763	36.6981
3104	12672	84	91.0639	81.3279	36.6855
3104	12672	85	92.0766	82.2637	36.72
3104	12672	86	93.2228	83.289	36.6945
3104	12672	87	94.2481	84.2478	36.7838
3104	12672	88	95.3824	85.2232	36.7034
3104	12672	89	96.333	86.1351	36.7239
3104	12672	90	97.486	87.1356	36.7016
3104	12672	91	98.5547	88.0625	36.7193
3104	12672	92	99.6608	89.0481	36.7155
3104	12672	93	100.61	89.9489	36.7055
3104	12672	94	101.78	90.9917	36.6924
3104	12672	95	102.844	91.9542	36.6944
3104	12672	96	103.969	92.8938	36.6878
3104	12672	97	104.863	93.8278	36.6895
3104	12672	98	106.117	94.8856	36.6604
3104	12672	99	107.171	95.8547	36.709
3104	12672	100	108.279	96.8019	36.7219
3104	12672	101	109.256	97.7473	36.7053
3104	12672	102	110.394	98.7583	36.6748
3104	12672	103	111.45	99.7306	36.6925
3104	12672	104	112.598	100.651	36.7164
3104	12672	105	113.577	101.602	36.7354
3104	12672	106	114.721	102.631	36.7131
3104	12672	107	115.767	103.582	36.6709
3104	12672	108	116.88	104.547	36.7089
3104	12672	109	117.887	105.458	36.721
3104	12672	110	119.056	106.498	36.6696
3104	12672	111	120.107	107.525	36.7032
3104	12672	112	121.264	108.397	36.66
3104	12672	113	122.124	109.335	36.749
3104	12672	114	123.359	110.42	36.6986
3104	12672	115	124.423	111.366	36.6896
3104	12672	116	125.515	112.336	36.7152
3104	12672	117	126.535	113.328	36.7353
3104	12672	118	127.733	114.379	36.7051
3104	12672	119	128.757	115.277	36.7203
3104	12672	120	129.848	116.222	36.7322
3104	12672	121	130.838	117.139	36.7161
3104	12672	122	132.025	118.175	36.667
3104	12672	123	133.055	119.109	36.7515
3104	12672	124	134.179	120.07	36.7016
3104	12672	125	135.158	121.051	36.7536
3104	12672	126	136.307	122.031	36.7489
3104	12672	127	137.351	123.005	36.7083
3104	12672	128	138.514	123.912	36.6763
3104	12672	129	139.394	124.847	36.6563
3104	12672	130	140.585	125.884	36.7186
3104	12672	131	141.647	126.837	36.6956
3104	12672	132	142.773	127.793	36.6988
3104	12672	133	143.744	128.721	36.6669
3104	12672	134	144.912	129.765	36.7341
3104	12672	135	145.977	130.729	36.7132
3104	12672	136	147.104	131.621	36.7011
3104	12672	137	148.065	132.59	36.6846
3104	12672	138	149.265	133.639	36.6969
3104	12672	139	150.306	134.592	36.7271
3104	12672	140	151.423	135.585	36.7104
3104	12672	141	152.42	136.49	36.7428
3104	12672	142	153.575	137.463	36.7179
3104	12672	143	154.642	138.49	36.7323
3104	12672	144	155.759	139.435	36.7247
3104	12672	145	156.702	140.369	36.7801
3104	12672	146	157.911	141.423	36.7104
3104	12672	147	158.967	142.365	36.678
3104	12672	148	160.084	143.301	36.7193
3104	12672	149	161.095	144.267	36.7152
3104	12672	150	162.265	145.276	36.6854
3104	12672	151	163.321	146.225	36.7016
3104	12672	152	164.396	147.163	36.7098
3104	12672	153	165.377	148.06	36.7489
3104	12672	154	166.568	149.129	36.7414
3104	12672	155	167.61	150.108	36.7094
3104	12672	156	168.745	151.045	36.7753
3104	12672	157	169.753	152.005	36.6907
3104	12672	158	170.89	153.035	36.6957
3104	12672	159	171.971	153.976	36.7229
3104	12672	160	173.088	154.883	36.7203
3104	12672	161	174.003	155.841	36.6848
3104	12672	162	175.244	156.872	36.6807
3104	12672	163	176.297	157.829	36.7246
3104	12672	164	177.402	158.806	36.7057
3104	12672	165	178.424	159.765	36.666
3104	12672	166	179.602	160.787	36.6743
3104	12672	167	180.619	161.727	36.7111
3104	12672	168	181.787	162.68	36.705
3104	12672	169	182.748	163.622	36.6668
3104	12672	170	183.947	164.705	36.736
3104	12672	171	185.006	165.684	36.7193
3104	12672	172	186.131	166.581	36.7122
3104	12672	173	187.154	167.523	36.6891
3104	12672	174	188.287	168.629	36.7124
3104	12672	175	189.325	169.603	36.6732
3104	12672	176	190.445	170.504	36.7384
3104	12672	177	191.394	171.448	36.6977
3104	12672	178	192.594	172.478	36.725
3104	12672	179	193.628	173.398	36.672
3104	12672	180	194.736	174.348	36.7274
3104	12672	181	195.759	175.277	36.6894
3104	12672	182	196.877	176.3	36.7444
3104	12672	183	197.931	177.276	36.6947
3104	12672	184	199.113	178.232	36.741
3104	12672	185	200.092	179.199	36.7299
3104	12672	186	201.277	180.233	36.7004
3104	12672	187	202.359	181.198	36.71
3104	12672	188	203.471	182.19	36.7509
3104	12672	189	204.424	183.052	36.6933
3104	12672	190	205.598	184.081	36.7453
3104	12672	191	206.666	185.083	36.7025
3104	12672	192	207.793	186.006	36.6834
3104	12672	193	208.722	186.934	36.7112
3104	12672	194	209.892	187.987	36.7192
3104	12672	195	210.959	188.919	36.6333
3104	12672	196	212.09	189.846	36.6846
3104	12672	197	213.05	190.803	36.7042
3104	12672	198	214.274	191.87	36.6713
3104	12672	199	215.27	192.842	36.751
3104	12672	200	216.456	193.781	36.7068
3104	12672	201	217.393	194.708	36.6483
3104	12672	202	218.626	195.727	36.752
3104	12672	203	219.667	196.749	36.6896
3104	12672	204	220.765	197.689	36.6984
3104	12672	205	221.791	198.601	36.6655
3104	12672	206	222.969	199.642	36.6897
3104	12672	207	224.049	200.635	36.6596
3104	12672	208	225.182	201.604	36.739
3104	12672	209	226.112	202.501	36.6767
3104	12672	210	227.274	203.549	36.6964
3104	12672	211	228.322	204.51	36.6879
3104	12672	212	229.425	205.387	36.7026
3104	12672	213	230.478	206.408	36.7621
3104	12672	214	231.678	207.448	36.7955
3104	12672	215	232.696	208.426	36.6952
3104	12672	216	233.849	209.379	36.7143
3104	12672	217	234.823	210.298	36.7363
3104	12672	218	236.032	211.333	36.7272
3104	12672	219	237.038	212.345	36.7292
3104	12672	220	238.151	213.197	36.6308
3104	12672	221	239.165	214.203	36.6879
3104	12672	222	240.286	215.185	36.6679
3104	12672	223	241.372	216.186	36.7481
3104	12672	224	242.519	217.089	36.7377
3104	12672	225	243.461	218.103	36.7244
3104	12672	226	244.629	219.079	36.689
3104	12672	227	245.678	220.044	36.7278
3104	12672	228	246.856	221.009	36.6779
3104	12672	229	247.85	222.008	36.6962
3104	12672	230	249.004	222.999	36.7307
3104	12672	231	250.046	223.958	36.6998
3104	12672	232	251.201	224.921	36.6927
3104	12672	233	252.162	225.885	36.6976
3104	12672	234	253.36	226.95	36.7259
3104	12672	235	254.438	227.906	36.6779
3104	12672	236	255.538	228.797	36.7198
3104	12672	237	256.559	229.787	36.6946
3104	12672	238	257.722	230.821	36.704
3104	12672	239	258.813	231.752	36.7004
3104	12672	240	259.891	232.665	36.7293
3104	12672	241	260.867	233.659	36.6941
3104	12672	242	262.023	234.659	36.7142
3104	12672	243	263.164	235.66	36.7154
3104	12672	244	264.277	236.625	36.72
3104	12672	245	265.278	237.575	36.7453
3104	12672	246	266.441	238.676	36.6987
3104	12672	247	267.524	239.586	36.7179
3104	12672	248	268.626	240.487	36.746
3104	12672	249	269.602	241.513	36.6512
3104	12672	250	270.826	242.516	36.6985
3104	12672	251	271.899	243.485	36.6826
3104	12672	252	272.976	244.402	36.7448
3104	12672	253	273.988	245.334	36.6514
3104	12672	254	275.194	246.403	36.7465
3104	12672	255	276.218	247.351	36.6915
3104	12672	256	277.249	248.231	36.7346
3104	12672	257	278.256	249.231	36.6885
3104	12672	258	279.5	250.259	36.6682
3104	12672	259	280.622	251.283	36.7023
3104	12672	260	281.731	252.202	36.7228
3104	12672	261	282.656	253.12	36.6877
3104	12672	262	283.847	254.195	36.7135
3104	12672	263	284.848	255.122	36.7141
3104	12672	264	286.036	256.02	36.7325
3104	12672	265	286.992	256.976	36.7245
3104	12672	266	288.14	258.024	36.6929
3104	12672	267	289.213	258.941	36.7655
3104	12672	268	290.296	259.884	36.682
3104	12672	269	291.37	260.848	36.7783
3104	12672	270	292.486	261.851	36.7731
3104	12672	271	293.563	262.821	36.6977
3104	12672	272	294.661	263.722	36.6922
3104	12672	273	295.639	264.711	36.6905
3104	12672	274	296.771	265.662	36.7233
3104	12672	275	297.806	266.698	36.681
3104	12672	276	298.953	267.591	36.6874
3104	12672	277	300.041	268.606	36.7312
3104	12672	278	301.173	269.646	36.7224
3104	12672	279	302.332	270.606	36.7002
3104	12672	280	303.365	271.468	36.6966
3104	12672	281	304.355	272.478	36.6997
3104	12672	282	305.572	273.488	36.7159
3104	12672	283	306.59	274.531	36.7126
3104	12672	284	307.73	275.361	36.6919
3104	12672	285	308.775	276.429	36.7469
3104	12672	286	309.976	277.424	36.7164
3104	12672	287	311.058	278.417	36.7414
3104	12672	288	312.129	279.294	36.7201
3104	12672	289	313.144	280.362	36.6774
3104	12672	290	314.362	281.362	36.6662
3104	12672	291	315.433	282.343	36.6939
3104	12672	292	316.483	283.219	36.7256
3104	12672	293	317.539	284.251	36.6663
3104	12672	294	318.721	285.313	36.7194
3104	12672	295	319.842	286.285	36.7047
3104	12672	296	320.929	287.214	36.6841
3104	12672	297	321.919	288.209	36.6935
3104	12672	298	323.11	289.228	36.6773
3104	12672	299	324.136	290.175	36.7047
3104	12672	300	325.256	291.039	36.7164
3104	12672	301	326.289	292.032	36.7149
3104	12672	302	327.473	293.103	36.7227
3104	12672	303	328.559	294.008	36.7128
3104	12672	304	329.671	295.024	36.6928
3104	12672	305	330.618	295.949	36.6695
3104	12672	306	331.841	296.951	36.72
3104	12672	307	332.969	297.963	36.7401
3104	12672	308	334.053	298.885	36.6844
3104	12672	309	335.067	299.848	36.6737
3104	12672	310	336.165	300.806	36.6997
3104	12672	311	337.202	301.811	36.7172
3104	12672	312	338.339	302.765	36.6916
3104	12672	313	339.264	303.65	36.7093
3104	12672	314	340.479	304.693	36.6756
3104	12672	315	341.567	305.678	36.6926
3104	12672	316	342.715	306.579	36.7284
3104	12672	317	343.686	307.594	36.7372
3104	12672	318	344.962	308.69	36.6751
3104	12672	319	346.042	309.707	36.7244
3104	12672	320	347.218	310.583	36.6962
3104	12672	321	348.084	311.521	36.7054
3104	12672	322	349.34	312.577	36.7104
3104	12672	323	350.443	313.563	36.745
3104	12672	324	351.577	314.495	36.6836
3104	12672	325	352.625	315.463	36.6648
3104	12672	326	353.671	316.444	36.7878
3104	12672	327	354.72	317.362	36.6885
3104	12672	328	355.889	318.373	36.6725
3104	12672	329	356.93	319.313	36.7324
3104	12672	330	358.129	320.365	36.7078
3104	12672	331	359.175	321.331	36.6629
3104	12672	332	360.319	322.237	36.7044
3104	12672	333	361.352	323.253	36.7221
3104	12672	334	362.45	324.142	36.7038
3104	12672	335	363.446	325.12	36.6983
3104	12672	336	364.81	326.021	36.7086
3104	12672	337	365.572	327.04	36.6577
3104	12672	338	366.91	328.175	36.7583
3104	12672	339	367.93	329.092	36.6689
3104	12672	340	369.004	330.037	36.636
3104	12672	341	370.037	330.966	36.7301
3104	12672	342	371.23	331.993	36.6956
3104	12672	343	372.354	332.975	36.7251
3104	12672	344	373.433	333.901	36.6776
3104	12672	345	374.466	334.911	36.6793
3104	12672	346	375.529	335.867	36.7144
3104	12672	347	376.579	336.793	36.7194
3104	12672	348	377.688	337.748	36.6644
3104	12672	349	378.745	338.755	36.6719
3104	12672	350	379.92	339.692	36.7172
3104	12672	351	381.053	340.751	36.7457
3104	12672	352	382.141	341.642	36.7522
3104	12672	353	383.063	342.838	36.693
3104	12672	354	384.311	343.889	36.6971
3104	12672	355	385.452	344.825	36.6859
3104	12672	356	386.579	345.747	36.7286
3104	12672	357	387.6	346.785	36.6522
3104	12672	358	388.663	347.791	36.7186
3104	12672	359	389.71	348.639	36.7145
3104	12672	360	390.881	349.605	36.7322
3104	12672	361	391.916	350.604	36.6743
3104	12672	362	393.157	351.673	36.6805
3104	12672	363	394.173	352.576	36.6783
3104	12672	364	395.214	353.528	36.6957
3104	12672	365	396.269	354.476	36.6701
3104	12672	366	397.426	355.476	36.715
3104	12672	367	398.411	356.447	36.6579
3104	12672	368	399.541	357.329	36.6806
3104	12672	369	400.428	358.287	36.7175
3104	12672	370	401.782	359.359	36.7725
3104	12672	371	402.813	360.341	36.7213
3104	12672	372	403.983	361.278	36.6858
3104	12672	373	404.97	362.183	36.6808
3104	12672	374	406.084	363.265	36.6876
3104	12672	375	407.228	364.31	36.6854
3104	12672	376	408.397	365.126	36.7194
3104	12672	377	409.351	366.199	36.6586
3104	12672	378	410.591	367.236	36.7452
3104	12672	379	411.647	368.286	36.733
3104	12672	380	412.845	369.214	36.7067
3104	12672	381	413.855	370.165	36.6671
3104	12672	382	415.065	371.224	36.7778
3104	12672	383	416.126	372.145	36.68];

% close all
clc

latexWidth =  5;
latexHeight = 4;   

a = a(1:256,:);

numToMin = 1;
x = a(:,3);
[gpu        xgpu]       = minWindows(x,a(:,4),numToMin);
[gpu_shared xgpu_shared]= minWindows(x,a(:,5),numToMin);
[gpu_fft    xgpu_fft]   = minWindows(x,a(:,6),numToMin);


figure(1); clf
plot(xgpu,gpu);hold on
plot(xgpu_shared,gpu_shared)
plot(xgpu_fft,gpu_fft)
grid on
axis tight
marge = axis;
axis([marge(1) marge(2) marge(3:4)])
ax = gca;
legend('Time Domain GPU global','Time Domain GPU shared','Frequency Domain  GPU','Location', 'NorthWest')
% title('Convolution CPU vs GPU 10 tap filter')
xlabel('filter length')
ylabel('time (ms)')

ax.FontName = 'Times New Roman';

ff = gcf;
homer = ff.Units;
ff.Units = 'inches';
bart = ff.Position;
ff.Position = [bart(1:2) latexWidth latexHeight];
ff.PaperPositionMode = 'auto';
ff.Units = homer;
drawnow
print(ff, '-depsc', ['CPUvsGPU_3104batch_12672signal_varyFilter']) %save as eps a
print(ff, '-dpng', ['CPUvsGPU_3104batch_12672signal_varyFilter']) %save as eps a

figure(2); clf;
plot(xgpu,gpu,'k-',xgpu_shared,gpu_shared,'k--',xgpu_fft,gpu_fft,'k-.');
% hold on
% plot(xcpu_fft,cpu_fft)
% plot(xgpu,gpu)
% plot(xgpu_shared,gpu_shared)
% plot(xgpu_fft,gpu_fft)
grid on
axis tight
marge = axis;
axis([marge(1) marge(2) marge(3:4)])
axis
ax = gca;
legend('Time Domain GPU global','Time Domain GPU shared','Frequency Domain  GPU','Location', 'NorthWest')
% title('Convolution CPU vs GPU 10 tap filter')
xlabel('filter length')
ylabel('time (ms)')

ax.FontName = 'Times New Roman';
% ax.Children(4).LineWidth = 1.25; %frequency domain CPU
% ax.Children(1).LineWidth = 1.25; %frequency domain GPU
% ax.Children(4).Color = 0.5*[1 1 1];

ff = gcf;
homer = ff.Units;
ff.Units = 'inches';
bart = ff.Position;
ff.Position = [bart(1:2) latexWidth latexHeight];
ff.PaperPositionMode = 'auto';
ff.Units = homer;
drawnow
% return

ax2 = axes('Position',[0.56 0.25 0.3 0.15]);
plot(xgpu,gpu,'k-',xgpu_shared,gpu_shared,'k--',xgpu_fft,gpu_fft,'k-.');
grid on;
% ax2.Children(4).LineWidth = 1.25; %frequency domain CPU
% ax2.Children(4).Color = 0.5*[1 1 1];
% ax2.Children(1).LineWidth = 1.25; %frequency domain GPU
axis([1 50 3.4543 60]);
ax2.FontSize = 6;
ax2.FontName = 'Times New Roman';
% ax2.XTick = [150 175 200];
% ax2.XTickLabel = {'9000','12000','15000'};


print(ff, '-depsc', ['CPUvsGPU_3104batch_12672signal_varyFilter']) %save as eps a
print(ff, '-dpng', ['CPUvsGPU_3104batch_12672signal_varyFilter']) %save as eps a